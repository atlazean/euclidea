\chapter{åœ†é”¥æ›²çº¿ Conics}

å°½ç®¡ tikz å†…ç½®çš„ \verbum{ellipse} å’Œ \verbum{parabola} ç»˜åˆ¶æ¤­åœ†å’ŒæŠ›ç‰©çº¿,
è¿™é‡Œå®šä¹‰äº† \mintinline{latex}|\ellipse| å’Œ \mintinline{latex}|\parabola|.

% ---------------------------------
\section{æ¤­åœ† Ellipse}

\subsection{å·²çŸ¥åŠé•¿è½´é•¿ a å’ŒåŠçŸ­è½´é•¿ b ç»˜å›¾}

\emph{è°ƒç”¨æ–¹å¼}

\begin{tcolorbox}{}
\mint{latex}{\ellipse [options] (a,b)}
\end{tcolorbox}

\emph{å‚æ•°è¯´æ˜}

\begin{description}
  \item[a, b] åŠé•¿è½´é•¿ (semi-major axis) å’ŒåŠçŸ­è½´é•¿ (semi-minor axis), é»˜è®¤å•ä½ä¸º cm, å¯æŒ‡å®šå•ä½, å¦‚ \verbum{(4cm, 3cm)}
\end{description}

è¿”å›ä¸­å¿ƒä¸ºåŸç‚¹çš„æ¤­åœ†æ›²çº¿: $\dfrac{x^2}{a^2}+\dfrac{y^2}{b^2}=1$.

\begin{remark*}
å½“æŒ‡å®šæ¤­åœ†æ›²çº¿ (ellipse) çš„ \verbum{domain} (default: \verbum{domain=-180:180})æ—¶, \verbum{domain} æ˜¯ä¸‹åˆ—å‚æ•°æ–¹ç¨‹ä¸­ $t$ çš„å–å€¼èŒƒå›´:
\begin{align*}
  \begin{cases}
  x = a \cos t,\\y = b \sin t
  \end{cases}
\end{align*}
\end{remark*}

\emph{ç¤ºä¾‹}

ä½¿ç”¨ tikz å†…ç½®æ›²çº¿:

\showcode{snippets/conics/ellipse1.tex}

ä½¿ç”¨ \mintinline{latex}|\ellipse| å‘½ä»¤:

\showcode{snippets/conics/ellipse2.tex}

% ---------------------------------
\subsection{ç”±ä¸¤ç„¦ç‚¹å’Œä¸€ç‚¹ç¡®å®šæ¤­åœ†}

\emph{è°ƒç”¨æ–¹å¼}

\begin{minted}{latex}
  `ellipse/define = {F1,F2,P}`: define an ellipse with two foci and a point.
  `ellipse`: creates the ellipse path.
  `ellipse/directrix/scale=k`: set the scale of directrices.
  `ellipse/directrix`: create the directrices.
  `ellipse/axis/scale=k`: set the scale of axes.
  `ellipse/axis`: create the axes.
  `ellipse/a`, `ellipse/b`, `ellipse/c`, `ellipse/e`: ellipse semimajor-axis, semiminor-axis, linear eccentricity, eccentricity.
\end{minted}

æ³¨æ„: \mint{latex}{ellipse/define = {F1,F2,P}} å¿…é¡»å•ç‹¬ä½¿ç”¨ tikzset å®šä¹‰æ‰èƒ½è®¿é—® /tikz/ellipse ä¸‹é¢çš„å˜é‡, è¿™å’Œä½œç”¨åŸŸæœ‰å…³.

\emph{ç¤ºä¾‹}

\showcode{snippets/conics/ellipse3.tex}

% ---------------------------------
\section{æ¤­åœ†å¼§ Arc}

\emph{åŸºæœ¬ç”¨æ³•}

åœ¨ TikZ ä¸­ç»˜åˆ¶åœ†å¼§å¯ä»¥é€šè¿‡ arc æ“ä½œ æ¥å®ç°, å°†æ¤­åœ†çš„ä¸€éƒ¨åˆ†æ·»åŠ åˆ°å½“å‰è·¯å¾„ä¸­.

\showcode{snippets/conics/arc1.tex}

åœ†å¼§ä»ç‚¹ (2,0) å¼€å§‹, ä»¥ 0 åº¦ï¼ˆç”±èµ·å§‹è§’åº¦æŒ‡å®šï¼‰ç»“æŸ, ä»¥ 300 åº¦ï¼ˆç”±ç»“æŸè§’åº¦æŒ‡å®šï¼‰ç»“æŸ.

ä¸ºäº†ç»˜åˆ¶åœ†çš„ä¸€éƒ¨åˆ†, æˆ‘ä»¬ä½¿ç”¨ä¸å‰ä¸€ä¸ªç›¸åŒçš„è¯­æ³•, å¹¶ä¸”ä¸æä¾›å‚æ•° x radius å’Œ y radius, è€Œæ˜¯ä»…æä¾›å‚æ•°radius.

\showcode{snippets/conics/arc2.tex}

\begin{itemize}

\item é»„è‰²æ‰‡åŒºæ˜¯é€šè¿‡ arc æ“ä½œç»˜åˆ¶çš„, ä¸ºäº†å¾—åˆ°åœ†çš„ä¸€éƒ¨åˆ†, æˆ‘ä»¬åªå®šä¹‰ radius è€Œä¸æ˜¯  x radius å’Œ y radius å‚æ•°. 

\item è“è‰²æ‰‡åŒºçš„ç»˜åˆ¶æ–¹å¼ä¸é»„è‰²æ‰‡åŒºç›¸åŒ, ä½†åœ¨æœ¬ä¾‹ä¸­æˆ‘ä»¬æŒ‡å®šäº† delta angle è€Œä¸æ˜¯ end angle, åè€…ç­‰äºstart angle + delta angle.

\end{itemize}

\emph{ç®€çŸ­è¯­æ³•}

ä¸Šå›¾ä¸­çš„å¼¯æ›²ç®­å¤´æ˜¯ä½¿ç”¨ arc æ“ä½œçš„è¾ƒçŸ­è¯­æ³•ç»˜åˆ¶çš„, å¯¹åº”äºåœ†çš„ä¸€éƒ¨åˆ†:

arc(start angle:end angle: radius)

å¯¹äºæ¤­åœ†, æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹è¯­æ³•: 

arc(start angle:end angle: x radius and y radius)

ç„¶è€Œ, è¿™ç§è¯­æ³•ä¸ç›´è§‚ä¸”éš¾ä»¥é˜…è¯», å› æ­¤ä¸€èˆ¬æƒ…å†µä¸‹åº”é¦–é€‰æ™®é€šè¯­æ³•(è§ PGF æ‰‹å†Œ).

% ---------------------------------
\section{æŠ›ç‰©çº¿ Parabola}

\subsection{å·²çŸ¥æ–¹ç¨‹ç³»æ•° a, b å’Œ c ç»˜å›¾}

\emph{è°ƒç”¨æ–¹å¼}

\begin{tcolorbox}{}
\mint{latex}{\parabola [options] (a,b,c)}
\end{tcolorbox}

\emph{å‚æ•°è¯´æ˜}

\begin{description}
  \item[a,b,c] äºŒæ¬¡å‡½æ•°çš„ç³»æ•°
\end{description}

è¿”å›æŠ›ç‰©çº¿: $y=ax^2+bx+c$.

\emph{ç¤ºä¾‹}

ä½¿ç”¨ tikz å†…ç½®æ›²çº¿:

\showcode{snippets/conics/parabola1.tex}

ä½¿ç”¨ \mintinline{latex}|\parabola| å‘½ä»¤:

\showcode{snippets/conics/parabola2.tex}

% ---------------------------------
\subsection{ç”±ç„¦ç‚¹å’Œé¡¶ç‚¹ç¡®å®šæŠ›ç‰©çº¿}

\emph{è°ƒç”¨æ–¹å¼}

\begin{minted}{latex}
  `parabola/define = {F,P}`: define a parabola with the focus and vertex.
  `parabola/domain=t1:t2`: set the domain for parametric equation: x = a*t^2, y = 2a*t, where `a` is the distance from the focus to the vertex.
  `parabola`: creates the parabola path.
  `parabola/directrix/scale=k`: set the scale of directrices.
  `parabola/directrix`: create the directrix.
  `parabola/axis/scale=k`: set the scale of axis.
  `parabola/axis`: create the axis.
  `parabola/a`, `parabola/e`: 1/4 parabola latus rectum, eccentricity (1.0).
\end{minted}

\emph{ç¤ºä¾‹}

\showcode{snippets/conics/parabola3.tex}

% ---------------------------------
\section{åŒæ›²çº¿ Hyperbola ä¸æ¸è¿‘çº¿ Asymptote}

\subsection{å·²çŸ¥åŠå®è½´é•¿ a å’ŒåŠè™šè½´é•¿ b ç»˜å›¾}

\emph{è°ƒç”¨æ–¹å¼}

\begin{tcolorbox}{}
\mint{latex}{\hyperbola [options] (a,b);}
\end{tcolorbox}

æˆ–

\begin{tcolorbox}{}
\mint{latex}{\asymptote [options] (a,b);}
\end{tcolorbox}

\emph{å‚æ•°è¯´æ˜}

\begin{description}
  \item[a, b] åŠå®è½´é•¿ (semi-major axis) å’ŒåŠè™šè½´é•¿ (semi-minor axis), é»˜è®¤å•ä½ä¸º cm, å¯æŒ‡å®šå•ä½, å¦‚ \verbum{(4cm, 3cm)}
\end{description}

åˆ†åˆ«è¿”å›ä¸­å¿ƒåœ¨åŸç‚¹çš„åŒæ›²çº¿: $\dfrac{x^2}{a^2}-\dfrac{y^2}{b^2}=1$ å’Œæ¸è¿‘çº¿: $y = \pm \dfrac{b}{a}x$.

\emph{ç¤ºä¾‹}

\showcode{snippets/conics/hyperbola1.tex}

\begin{remark*}
å½“æŒ‡å®šç»˜åˆ¶åŒæ›²çº¿ (hyperbola) çš„ \verbum{domain} (default: \verbum{domain=-1.5:1.5})æ—¶, \verbum{domain} æ˜¯ä¸‹åˆ—åŒæ›²çº¿å‚æ•°æ–¹ç¨‹ä¸­ $t$ çš„å–å€¼èŒƒå›´:
\begin{align*}
  \begin{cases}
  x = \pm a \cosh t,\\y = b \sinh t
  \end{cases}
\end{align*}

$t$ çš„å‡ ä½•æ„ä¹‰: å°„çº¿å‡ºåŸç‚¹äº¤å•ä½åŒæ›²çº¿ $x^2-y^2=1$ äº $(x = \cosh t, y = \sinh t)$,
$t$ æ˜¯å°„çº¿,åŒæ›²çº¿å’Œ $x$ è½´å›´æˆçš„é¢ç§¯çš„äºŒå€. å¯¹äºåŒæ›²çº¿ä¸Šä½äº $x$ è½´ä¸‹æ–¹çš„ç‚¹, è¿™ä¸ªé¢ç§¯è¢«è®¤ä¸ºæ˜¯è´Ÿå€¼.

å½“æŒ‡å®šç»˜åˆ¶æ¸è¿›çº¿ (asymptote) çš„ \verbum{domain} (default: \verbum{domain=-2:2})æ—¶, \verbum{domain} æ˜¯ä¸‹åˆ—ç›´çº¿æ–¹ç¨‹ä¸­ $x$ çš„å–å€¼èŒƒå›´:
\begin{align*}
  y = \pm \dfrac{b}{a} x
\end{align*}
\end{remark*}

\emph{ç¤ºä¾‹}

\showcode{snippets/conics/hyperbola2.tex}

ä¹Ÿå¯ä½¿ç”¨ pgfplots åº•å±‚å‡½æ•°æ¥ç»˜åˆ¶åŒæ›²çº¿:

\emph{ç¤ºä¾‹}

\showcode{snippets/conics/hyperbola3.tex}

% ---------------------------------
\subsection{ç”±ä¸¤ç„¦ç‚¹å’Œä¸€ç‚¹ç¡®å®šåŒæ›²çº¿}

\emph{è°ƒç”¨æ–¹å¼}

\begin{minted}{latex}
  `hyperbola/define = {F1,F2,P}`: define a hyperbola with two foci and a point.
  `hyperbola/domain=t1:t2`: set the domain for parametric equation: x = a*cosh(t), y = b*sinh(t).
  `hyperbola`: creates the hyperbola path.
  `hyperbola/directrix/scale=k`: set the scale of directrices.
  `hyperbola/directrix`: create the directrices.
  `hyperbola/axis/scale=k`: set the scale of axes.
  `hyperbola/axis`: create the axes.
  `hyperbola/a`, `hyperbola/b`, `hyperbola/c`, `hyperbola/e`: hyperbola semimajor-axis, semiminor-axis, linear eccentricity, eccentricity.
\end{minted}

\emph{ç¤ºä¾‹}

\showcode{snippets/conics/hyperbola4.tex}

% ---------------------------------
\section{è¿‡æ¤­åœ†å¤–ä¸€ç‚¹ä½œæ¤­åœ†çš„åˆ‡çº¿ Tangents to an Ellipse}

è¿‡æ¤­åœ†å¤–ä¸€ç‚¹ä½œæ¤­åœ†çš„åˆ‡çº¿çš„æ–¹æ³•æœ‰: åˆ©ç”¨æ¤­åœ†çš„å…‰å­¦æ€§è´¨ä½œå›¾; 
æˆ–è€…æ ¹æ®å°„å½±å‡ ä½•ç†è®º, é‡‡ç”¨æç‚¹æçº¿æ³•.æ­¤å¤„é‡‡ç”¨å‰è€….

æ–¹æ³• 1: 

\begin{enumerate}
  \item ä½œå‡ºæ¤­åœ†çš„è¾…åŠ©åœ† (ä»¥æ¤­åœ†ä¸­å¿ƒä¸ºåœ†å¿ƒ, ä»¥é•¿åŠè½´é•¿ $a$ ä¸ºåŠå¾„çš„åœ†);
  \item ä½œå‡ºä¸€ä¸ªä»¥ $PF_1$ æˆ– $PF_2$ ä¸ºç›´å¾„çš„åœ†;
  \item ä¸¤åœ†äº¤äº $Q,R$, åˆ™ç›´çº¿ $PQ,PR$ å³ä¸ºæ‰€æ±‚.
\end{enumerate}

\showcode{snippets/conics/tangents-of-ellipse-1.tex}

æ–¹æ³• 2: 

\begin{enumerate}
  \item ä½œå‡ºä¸€ä¸ªä»¥ $F_1$ ä¸ºåœ†å¿ƒ, $2a$ ä¸ºåŠå¾„çš„åœ†;
  \item ä½œå‡ºä¸€ä¸ªä»¥ $F_2$ ä¸ºåœ†å¿ƒ, $PF_2$ ä¸ºåŠå¾„çš„åœ†;
  \item ä¸¤åœ†äº¤äº $Q,R$, åˆ™ $F_2Q,F_2R$ çš„ä¸­å‚çº¿å³ä¸ºæ‰€æ±‚.
\end{enumerate}

\showcode{snippets/conics/tangents-of-ellipse-2.tex}

% ---------------------------------
\section{è¿‡åŒæ›²çº¿å¤–ä¸€ç‚¹ä½œåŒæ›²çº¿çš„åˆ‡çº¿ Tangents to a Hyperbola}

ç±»ä¼¼æ¤­åœ†çš„åˆ‡çº¿ä½œæ³•, å¯¹äºåŒæ›²çº¿åŒæ ·æœ‰ä¸‹é¢çš„æ–¹æ³•:

\showcode{snippets/conics/tangents-of-Hyperbola-1.tex}

\showcode{snippets/conics/tangents-of-Hyperbola-2.tex}

% ---------------------------------
\section{è¿‡æŠ›ç‰©çº¿å¤–ä¸€ç‚¹ä½œæŠ›ç‰©çº¿çš„åˆ‡çº¿ Tangents to a Parabola}

æŠ›ç‰©çº¿çš„åˆ‡çº¿ä½œæ³•å¦‚ä¸‹:

\begin{enumerate}
  \item ä»¥ç‚¹ $P$ ä¸ºåœ†å¿ƒ, $PF$ ä¸ºåŠå¾„ä½œåœ†, äº¤å‡†çº¿å°†äº $Q,R$;
  \item $FQ,FR$ çš„ä¸­å‚çº¿å³ä¸ºæ‰€æ±‚.
\end{enumerate}

% ---------------------------------
\section{è¿‡äº”ç‚¹ä½œåœ†é”¥æ›²çº¿ Five Points Determine a Conic}

\emph{åŸç†}

è®¾äºŒæ¬¡æ›²çº¿çš„æ–¹ç¨‹ä¸º:

\[
  ax^2 + bxy + cy^2 + dx + ey + f = 0
\]

å°† $(x_i,y_i) (i=1,2,\cdots,5)$ ä»£å…¥ä¸Šå¼, å¹¶ç»„æˆçº¿æ€§æ–¹ç¨‹ç»„.
ç”±äº $(a, b, c, d, e, f) \neq \mathbf{0}$, è¯¥æ–¹ç¨‹ç»„çš„ç³»æ•°çŸ©é˜µçš„è¡Œåˆ—å¼ä¸º 0, å³:

\[
\det \begin{pmatrix}
x^2 & xy & y^2 & x & y & 1 \\
x^2_1 & x_1y_1 & y^2_1 & x_1 & y_1 & 1 \\
x^2_2 & x_2y_2 & y^2_2 & x_2 & y_2 & 1 \\
x^2_3 & x_3y_3 & y^2_3 & x_3 & y_3 & 1 \\
x^2_4 & x_4y_4 & y^2_4 & x_4 & y_4 & 1 \\
x^2_5 & x_5y_5 & y^2_5 & x_5 & y_5 & 1 \\
\end{pmatrix} = 0
\]

åŒ–ç®€è¯¥è¡Œåˆ—å¼å³å¾—åˆ°äºŒæ¬¡æ›²çº¿çš„æ–¹ç¨‹.

Braikenridge-Maclaurin å®šç†æŒ‡å‡ºï¼Œå¦‚æœé€šè¿‡å…­è¾¹å½¢çš„ç›¸å¯¹ä¾§çš„ä¸‰å¯¹çº¿çš„ä¸‰ä¸ªäº¤ç‚¹ä½äºä¸€æ¡ç›´çº¿ä¸Šï¼Œåˆ™å…­è¾¹å½¢çš„å…­ä¸ªé¡¶ç‚¹ä½äºåœ†é”¥ä¸Š. è¿™å®é™…ä¸Šæ˜¯ Pascal å®šç†çš„é€†å®šç†.

\emph{ç¤ºä¾‹}

\showcode{snippets/conics/five-points-determine-a-conic.tex}

% ---------------------------------
\section{ä¸äº”æ¡ç›´çº¿ç›¸åˆ‡çš„åœ†é”¥æ›²çº¿ Five Tangents Determine a Conic}

\emph{åŸç†}

æ ¹æ®å¯¹å¶åŸç†, äºŒæ¬¡æ›²çº¿å¯ä»¥ç”¨ä¸¤ç§æ–¹å¼å®šä¹‰, ç‚¹å½¢å¼å’Œç›´çº¿å½¢å¼:

ç‚¹å½¢å¼å®šä¹‰: ç”±ç‚¹é›†æ»¡è¶³çš„äºŒæ¬¡æ–¹ç¨‹å®šä¹‰, ä¾‹å¦‚:
  \[
  ax^2 + bxy + cy^2 + dxz + eyz + fz^2 = 0
  \]
  
ç”¨çŸ©é˜µå½¢å¼è¡¨ç¤ºä¸º:
  \[
  (x, y, z) \begin{pmatrix} a & b/2 & d/2 \\ b/2 & c & e/2 \\ d/2 & e/2 & f \end{pmatrix} \begin{pmatrix} x \\ y \\ z \end{pmatrix} = 0
  \]
ç§°è¯¥çŸ©é˜µä¸º \( Q \).

è®¾ $(x_0,y_0,z_0)$ æ˜¯æ›²çº¿ä¸Šçš„ç‚¹,  åˆ™è¿‡è¯¥ç‚¹çš„åˆ‡çº¿æ–¹ç¨‹ä¸º:

\[
  (x,y,z) \begin{pmatrix} a & b/2 & d/2 \\ b/2 & c & e/2 \\ d/2 & e/2 & f \end{pmatrix} \begin{pmatrix} x_0 \\ y_0 \\ z_0 \end{pmatrix} = 0
\]


ç›´çº¿å½¢å¼å®šä¹‰: ç”±æ‰€æœ‰ä¸åŸæ›²çº¿ç›¸åˆ‡çš„ç›´çº¿çš„åŒ…ç»œå®šä¹‰ï¼Œç”¨ç›´çº¿åæ ‡ \( (l, m, n) \) çš„äºŒæ¬¡æ–¹ç¨‹è¡¨ç¤º:
  \[
  Al^2 + Blm + Cm^2 + Dlm + Emn + Fn^2 = 0
  \]
åŒæ ·ç”¨çŸ©é˜µå½¢å¼ï¼š
  \[
  (l, m, n) \begin{pmatrix} A & B/2 & D/2 \\ B/2 & C & E/2 \\ D/2 & E/2 & F \end{pmatrix} \begin{pmatrix} l \\ m \\ n \end{pmatrix} = 0
  \]
ç§°è¯¥çŸ©é˜µä¸º $Q^*$. $Q^*$ æ˜¯ $Q$ çš„ä¼´éšçŸ©é˜µ:

\[
  Q^{-1} = \dfrac{Q^*}{\det(Q)}.
\]

æˆ‘ä»¬å¯ä»¥æ ¹æ® 5 æ¡ç›´çº¿çš„æ–¹ç¨‹æ±‚å‡º $Q^*$, åœ¨æ±‚å…¶é€†çŸ©é˜µ, ä»è€Œå¾—åˆ°æ›²çº¿çš„æ–¹ç¨‹.

Find dual conic\footnote{\url{https://math.stackexchange.com/questions/460404/finding-dual-conic}}:

Taking the quadratic form $p^TAp=0$ and remembering $A$ 
is symmetric, we can also transform it:
\begin{gather*}
  p^T(AA^{-1})Ap=0 \\
  p^TA^TA^{-1}Ap=0 \\
  (Ap)^TA^{-1}(Ap)=0 
\end{gather*}

This modified form can be interpreted as the dual of the primal conic described by the quadratic form $l^ğ‘‡ğ´^{âˆ’1}l=0$
, where every $l=Ap$ that satisfies this equation is tangent to the primal conic.

Additionally, the adjugate of $A$ can mostly be substituted for the inverse because $A^{-1}=adj(A)/det(A)$.

ä¸‹é¢çš„ä½œå›¾é‡‡ç”¨ Brianchon å®šç†ä¸­é€€åŒ–çš„å¤–åˆ‡å…­è¾¹å½¢, æ±‚å‡ºå„è¾¹çš„åˆ‡ç‚¹, ç„¶åæ ¹æ® 5 ç‚¹ç¡®å®šä¸€ä¸ª
åœ†é”¥æ›²çº¿ (ç•¥).

\emph{ç¤ºä¾‹}

\showcode{snippets/conics/five-tangents-determine-a-conic.tex}


