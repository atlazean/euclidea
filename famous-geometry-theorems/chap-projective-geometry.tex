\chapter{射影几何 Projective Geometry}

射影几何是非欧几里得几何,属于高等几何内容\cite{projgeo}.

\section{笛沙格定理 Desargues's theorem}
\begin{theorem}[笛沙格定理,Desargues's theorem]
在射影空间中,有六点$A_1$,$B_1$,$C_1$,$A_2$,$B_2$,$C_2$,
直线$A_1A_2$,$B_1B_2$,$C_1C_2$共点当且仅当
$A_1B_1 \cap A_2B_2$,$B_1C_1 \cap B_2C_2$, $C_1A_1 \cap C_2A_2$共线.
\end{theorem}
在射影几何的对偶性来看,笛沙格定理是自对偶的.

\begin{figure}[!htp]
\begin{center}
\begin{tikzpicture}[scale=.55]
  \tikzmath{
    \a = 160; % 直线 A1A2 的倾角
    \b = 180; % 直线 B1B2 的倾角
    \c = 200; % 直线 C1C2 的倾角
  }
  \coordinate (A1) at (\a:5);
  \coordinate (B1) at (\b:4);
  \coordinate (C1) at (\c:7);
  \coordinate (A2) at (\a:11);
  \coordinate (B2) at (\b:7);
  \coordinate (C2) at (\c:10);
  \coordinate (O) at (0,0);
  \coordinate[intersect={B1,C1,B2,C2}] (X);
  \coordinate[intersect={C1,A1,C2,A2}] (Y);
  \coordinate[intersect={A1,B1,A2,B2}] (Z);
  \draw[thick,teal] (A1) -- (B1) -- (C1) -- cycle; 
  \draw[thick,magenta] (A2) -- (B2) -- (C2) -- cycle; 
  \draw[blue] (O) -- (A2) (O) -- (B2) (O) -- (C2);
  \draw[cyan] (X) -- (Z);
  \draw[purple] (C1) -- (X) (C2) -- (X);
  \draw[purple] (C1) -- (Y) (C2) -- (Y);
  \draw[purple] (B1) -- (Z) (B2) -- (Z);
  \foreach \p in {A1,B1,C1,A2,B2,C2,X,Y,Z}
    \fill[red] (\p) circle (2pt);
  \draw (A1) node[above] {$A_1$};
  \draw (B1) node[left] {$B_1$};
  \draw (C1) node[below] {$C_1$};
  \draw (A2) node[above] {$A_2$};
  \draw (B2) node[left] {$B_2$};
  \draw (C2) node[below] {$C_2$};
  \draw (X) node[below] {$X$};
  \draw (Y) node[below] {$Y$};
  \draw (Z) node[below] {$Z$};
  \draw (O) node[right] {$O$};
\end{tikzpicture}
\end{center}
\caption{笛沙格定理}
\end{figure}

\section{帕普斯定理 Pappus's hexagon theorem}
\begin{theorem}[帕普斯定理,Pappus's hexagon theorem\label{pappus}]
设 $A_1,A_3,A_5$ 和 $A_2,A_4,A_6$ 为共面二直线上的两组共线点, 若
$A_1A_2 \cap A_4A_5 = X,A_2A_3 \cap A_5A_6 = Y,A_3A_4 \cap A_6A_1 = Z$,
则$X,Y,Z$共线.
\end{theorem}

\begin{remark*}
  这是\hyperref[pascal]{帕斯卡定理}的退化形式, $A_1A_2A_3A_4A_5A_6$构成简单六点形,
三对对边的交点共线.
\end{remark*}

\begin{figure}[!htp]
\begin{center}
\begin{tikzpicture}
  \tikzmath{
    \a = 30; % 直线 a 的倾角
    \b = 0;  % 直线 b 的倾角
  }
  % 批量定义坐标
  \foreach \i/\angle/\distance in {1/\a/2, 3/\a/11, 5/\a/5,
  2/\b/6, 4/\b/3,  6/\b/9} {
    \coordinate (A\i) at (\angle:\distance);
  }

  \coordinate (O) at (0,0);
  \coordinate[intersect={A1,A2,A4,A5}] (X);
  \coordinate[intersect={A2,A3,A5,A6}] (Y);
  \coordinate[intersect={A3,A4,A6,A1}] (Z);

  \draw[blue,thick] (O) -- (A3) (O) -- (A6);
  \draw[cyan,thick] (X) -- (Y);
  \draw[purple] (A1) -- (A2) (A4) -- (A5);
  \draw[teal] (A2) -- (A3) (A5) -- (A6);
  \draw[magenta] (A3) -- (A4) (A6) -- (A1);

  \foreach \p/\placement/\text in {A1/above/A_1, A2/below/A_2, A3/above/A_3,
  A4/below/A_4, A5/above/A_5, A6/below/A_6, 
  X/below/X, Y/below/Y, Z/below/Z} {
    \fill[red] (\p) circle (2pt);
    \draw (\p) node[\placement] {$\text$};
  }
\end{tikzpicture}
\end{center}
\caption{帕普斯定理}
\end{figure}

\section{帕斯卡定理 Pascal's theorem}

\begin{theorem}[帕斯卡定理,Pascal's theorem\label{pascal}]
  对于任意一个内接于非退化的二阶曲线的简单六点形, 它的三对对边的交点在一条直线上. 或者说, 
圆锥曲线的内接六边形其三条对边的交点共线.
\end{theorem}

它与\hyperref[brianchon]{布列安桑定理}对偶, 是帕普斯定理的推广.(当这个圆锥曲线退化成两条直线时, 
帕斯卡定理就会变成\hyperref[pappus]{帕普斯定理})
该定理由法国数学家布莱士·帕斯卡于16岁时提出但并未证明, 是射影几何中的一个重要定理.

\begin{remark*}
  这里的内接六边形不一定是凸六边形, 对于任意的简单六点形 $A_1A_2A_3A_4A_5A_6$, 其三对对边分别是:
$A_1A_2$ 和 $A_4A_5$, $A_2A_3$ 和 $A_5A_6$, $A_3A_4$ 和 $A_6A_1$. 如图\ref{pascal-fig1}和图\ref{pascal-fig2}.
\end{remark*}

\begin{figure}[!htp]
\begin{center}
\begin{tikzpicture}
  \tikzmath{
    % 椭圆参数
    \a = 4;
    \b = 3;
  }
  \tikzset{
    % 图形整体旋转
    rotate = 136,
  }
  
  % 批量定义坐标
  \foreach \i/\angle in {1/75, 2/105, 3/135, 4/180, 5/200, 6/300} {
    \coordinate (A\i) at ({\a*cos(\angle)}, {\b*sin(\angle)});
  }

  \coordinate (O) at (0,0);
  \coordinate[intersect={A1,A2,A4,A5}] (X);
  \coordinate[intersect={A2,A3,A5,A6}] (Y);
  \coordinate[intersect={A3,A4,A6,A1}] (Z);

  \draw[red,thick] (0,0) ellipse [x radius=\a,y radius=\b];
  \draw[blue,thick] (A1) -- (A2) -- (A3) -- (A4) -- (A5) -- (A6) -- cycle;
  \draw[cyan,thick] (Y) -- (Z);
  \draw[purple] (A2) -- (X) (A4) -- (X);
  \draw[teal] (A2) -- (Y) (A6) -- (Y);
  \draw[magenta] (A1) -- (Z) (A3) -- (Z);

  \foreach \p/\placement/\text in {A1/left/A_1, A2/below/A_2, A3/below/A_3,
  A4/below/A_4, A5/right/A_5, A6/above/A_6, 
  X/below/X, Y/below/Y, Z/below/Z} {
    \fill[red] (\p) circle (2pt);
    \draw (\p) node[\placement] {$\text$};
  }
\end{tikzpicture}
\end{center}
\caption{帕斯卡定理}
\label{pascal-fig1}
\end{figure}

\begin{figure}[!htp]
\begin{center}
\begin{tikzpicture}
  \tikzmath{
    % 椭圆参数
    \a = 4;
    \b = 3;
  }
  \tikzset{
    % 图形整体旋转
    rotate = 136,
  }
  
  % 批量定义坐标
  \foreach \i/\angle in {1/75, 4/135, 2/185, 6/245, 3/305, 5/365} {
    \coordinate (A\i) at ({\a*cos(\angle)}, {\b*sin(\angle)});
  }

  \coordinate (O) at (0,0);
  \coordinate[intersect={A1,A2,A4,A5}] (X);
  \coordinate[intersect={A2,A3,A5,A6}] (Y);
  \coordinate[intersect={A3,A4,A6,A1}] (Z);
  
  \draw[red,thick] (0,0) ellipse [x radius=\a,y radius=\b];
  \draw[blue,thick] (A1) -- (A2) -- (A3) -- (A4) -- (A5) -- (A6) -- cycle;
  \draw[cyan,thick] (X) -- (Y);
  
  \foreach \p/\placement/\text in {A1/left/A_1, A2/below/A_2, A3/above/A_3,
  A4/below/A_4, A5/above left/A_5, A6/above right/A_6, 
  X/below left/X, Y/above right/Y, Z/below right/Z} {
    \fill[red] (\p) circle (2pt);
    \draw (\p) node[\placement] {$\text$};
  }
\end{tikzpicture}
\end{center}
\caption{帕斯卡定理}
\label{pascal-fig2}
\end{figure}

\section{布列安桑定理 Brianchon's theorem}

\begin{theorem}[布列安桑定理,Brianchon's theorem\label{brianchon}]
  对于任意一个外切于非退化的二阶曲线的简单六线形, 它的三对对顶点的连线通过一个点. 或者说, 
设$A_1A_2A_3A_4A_5A_6$为圆锥曲线的外切六边形,则直线$A_1A_4,A_2A_5,A_3A_6$三线共点.
\end{theorem}

布列安桑定理的对偶定理是\hyperref[pascal]{帕斯卡定理}.

\begin{figure}[!htp]
\begin{center}
\begin{tikzpicture}
  \tikzmath{
    % 椭圆参数
    \a = 4;
    \b = 3;
  }
  \tikzset{
    % 图形整体旋转
    rotate = 136,
  }
  
  % 批量定义坐标
  \foreach \i/\angle in {1/75, 2/135, 3/185, 4/245, 5/305, 6/365} {
    % 椭圆上的点
    \coordinate (P\i) at ({\a*cos(\angle)}, {\b*sin(\angle)});
    % 该点上的切向量
    \coordinate (T\i) at (-{\a*sin(\angle)}, {\b*cos(\angle)});
    % 该点上的切线上的一点
    \coordinate (Q\i) at ($(P\i)+(T\i)$);
  }

  \coordinate[intersect={P1,Q1,P2,Q2}] (A1);
  \coordinate[intersect={P2,Q2,P3,Q3}] (A2);
  \coordinate[intersect={P3,Q3,P4,Q4}] (A3);
  \coordinate[intersect={P4,Q4,P5,Q5}] (A4);
  \coordinate[intersect={P5,Q5,P6,Q6}] (A5);
  \coordinate[intersect={P6,Q6,P1,Q1}] (A6);

  \draw[red,thick] (0,0) ellipse [x radius=\a,y radius=\b];
  \draw[teal,thick] (A1) -- (A2) -- (A3) -- (A4) -- (A5) -- (A6) -- cycle;
  \draw[purple] (A1) -- (A4) (A2) -- (A5) (A3) -- (A6);

  \foreach \p/\placement/\text in {A1/below/A_1, A2/below/A_2, A3/above right/A_3,
  A4/above right/A_4, A5/above/A_5, A6/above left/A_6} {
    \fill[red] (\p) circle (2pt);
    \draw (\p) node[\placement] {$\text$};
  }

\end{tikzpicture}
\end{center}
\caption{布列安桑定理}
\end{figure}

\section{极点和极线 Pole and polar}

切点切线:可以理解为曲线过某一点(切点)且斜率为曲线在该点的导数的直线.

极点极线:如果圆锥曲线的切于A,B两点的切线相交于P点,
那么P点称为直线AB关于该曲线的极点(pole),
直线AB称为P点的极线(polar).

利用极点和极线的性质作圆的切线:

\begin{figure}[!htp]
\begin{center}
\begin{tikzpicture}
  \tikzmath{
    \r = 3;
  }
  \coordinate (O) at (0,0);
  \coordinate (P) at (4,6);
  \coordinate (M) at (-3,-2);
  \coordinate (N) at (2,-4);
  \draw[thick,red,name path=circle] (O) circle (\r);
  \draw[thick,name path=l1] (P) -- (M);
  \draw[thick,name path=l2] (P) -- (N);
  \path[name intersections={of= circle and l1,sort by=l1,by={A,B}}];
  \path[name intersections={of= circle and l2,sort by=l2,by={C,D}}];
  \coordinate[intersect={A,D,B,C}] (E);
  \coordinate[intersect={A,C,B,D}] (F);
  \draw[red,thick,name path=l3] (E) -- (F);
  \path[name intersections={of= circle and l3,sort by=l3,by={G}}];
  \draw[thick,cyan] (A) -- (F) (B) -- (F) (A) -- (D) (B) -- (C);
  \draw[blue,thick] (P) -- (G);
  \foreach \p in {O,P,A,B,C,D,E,F,G}
    \fill[red] (\p) circle (2pt);
  \draw (O) node[below] {$O$};
  \draw (P) node[above] {$P$};
  \draw (A) node[above] {$A$};
  \draw (B) node[below] {$B$};
  \draw (C) node[right] {$C$};
  \draw (D) node[below right] {$D$};
  \draw (E) node[above] {$E$};
  \draw (F) node[below] {$F$};
  \draw (G) node[right] {$G$};
\end{tikzpicture}
\end{center}
\caption{极点与极线}
\end{figure}

\section{彭赛列闭合定理 Poncelet's closure theorem}

彭赛列闭合定理（Poncelet's Closure Theorem）是几何学中的一个经典定理，由法国数学家 让-维克托·彭赛列（Jean-Victor Poncelet） 在 19 世纪提出。

\begin{theorem}[彭赛列闭合定理 Poncelet's closure theorem\label{poncelet}]
  设 $C_1$ 和 $C_2$ 是两个圆锥曲线，且 $C_2$ 完全位于 $C_1$ 的内部。如果存在一个 
$n$-边形 $P$, 使得: $P$ 的所有顶点都在 $C_1$ 上；$P$ 的所有边都与 
$C_2$ 相切; 那么, 对于任意一个初始点 $p_0 \in C_1$, 都可以通过以下步骤构造一个闭合的 
$n$-边形:从 $p_0$ 出发, 画一条与 $C_2$ 相切的直线, 交 $C_1$ 于 $p_1$; 重复上述步骤,
直到回到 $p_0$ 形成一个闭合多边形.
\end{theorem}

由于彭赛列闭合定理涉及圆锥曲线, 作图时通常需要借助计算机辅助软件动态调整参数直到多边形闭合, 例如: Geogebra 或其他类似的软件。
若 $C_1,C_2$ 为同心圆, 正多边形即能满足内接外切条件。

下图是以 $n = 3$ 为例的两个圆:

\begin{figure}[!htp]
\begin{center}

  \begin{tikzpicture}
    \axes(-5:5,-5:5);
    \tikzmath{
      \r = 4;
    }
    \foreach \i/\angle in {1/75,2/-135,3/-30} {
      \coordinate (A\i) at (\angle:\r);
    }

    \draw[thick,teal] (A1) -- (A2) -- (A3) -- cycle;

    % 外接圆
    \coordinate (O) at (0,0);% 圆心
    \draw[thick,purple] (O) circle (\r);

    % A1 A2 A3 的内切圆
    \coordinate[incenter={A1,A2,A3}] (I);
    \coordinate (P) at ($(A1)!(I)!(A2)$);%temp
    \draw[thick,violet,circle={I,P}];

    % 求 B1 向内切圆切线的切点
    \coordinate (B1) at (140:\r);
    \tikzset{circle-tangent={I,P,B1}};%tp1,tp2
    % 求切线与外接圆的交点
    \tikzset{circle-line={O,A1,B1,tp1}}
    \coordinate (B2) at (cl1);%cl2 即 B1
    \tikzset{circle-line={O,A1,B1,tp2}}
    \coordinate (B3) at (cl1);%cl2 即 B1

    \draw[thick,blue] (B1) -- (B2) -- (B3) -- cycle;

    \foreach \p/\placement in {A1/above,A2/below left,A3/below right,
    B1/above,B2/below,B3/right} {
      \fill[red] (\p) circle (2pt);
      \draw (\p) node[\placement] {$\p$};
    }

  \end{tikzpicture}

\end{center}
\caption{彭赛列闭合定理($n=3$)}
\end{figure}

