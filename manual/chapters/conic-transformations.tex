\chapter{åœ†é”¥æ›²çº¿çš„å˜æ¢ Conic Transformations}

\section{åæ ‡å˜æ¢ Coordinate Transformations}

ä¸‹é¢è®¨è®ºåæ ‡è½´å¹³ç§»å’Œæ—‹è½¬ååæ ‡çš„å˜åŒ–.

\subsection{Translation}

\begin{center}
\begin{tikzpicture}
  \tikzmath{
    \xmin = 0;
    \xmax = 3;
    \ymin = 0;
    \ymax = 3;
    \dx = 1.5;
    \dy = 1;
  }
  % original coordinate system
  \draw[-latex] ({(\xmin)-0.5},0) -- ({(\xmax)+0.5},0) node[below] {$x$};
  \draw[-latex] (0,{(\ymin)-0.5}) -- (0,{(\ymax)+0.5}) node[left] {$y$};
  \draw (0,0) node[below left] {$O$};
  % the transformed coordinate system
  \draw[red,-latex] ({(\xmin)-0.5},\dy) -- ({(\xmax)+0.5},\dy) node[below] {$x'$};
  \draw[red,-latex] (\dx,{(\ymin)-0.5}) -- (\dx,{(\ymax)+0.5}) node[left] {$y'$};
  \draw[red] (\dx,\dy) node[below left] {$O'$};
  \coordinate (P) at (2.5,2.5);
  \foreach \p/\placement in {P/above}{
    \fill[teal] (\p) circle (2pt);
    \draw (\p) node[\placement] {$\p$};
  }
\end{tikzpicture}
\end{center}

\[
  \begin{cases}
    x' = x - dx\\
    y' = y - dy
  \end{cases}
\]

\[
  \begin{pmatrix}
    x'\\
    y'\\
    1
  \end{pmatrix}
  =
  \begin{pmatrix}
    1 & 0 & -d_x\\
    0 & 1 & -d_y\\
    0 & 0 & 1
  \end{pmatrix}
  \begin{pmatrix}
    x\\
    y\\
    1
  \end{pmatrix}
\]

\[
  \begin{pmatrix}
    x\\
    y\\
    1
  \end{pmatrix}
  =
  \begin{pmatrix}
    1 & 0 & d_x\\
    0 & 1 & d_y\\
    0 & 0 & 1
  \end{pmatrix}
  \begin{pmatrix}
    x'\\
    y'\\
    1
  \end{pmatrix}
\]

\subsection{Rotation}

\begin{center}
\begin{tikzpicture}
  \tikzmath{
    \xmin = 0;
    \xmax = 3;
    \ymin = 0;
    \ymax = 3;
    \a = 15;
  }
  % original coordinate system
  \draw[-latex] ({(\xmin)-0.5},0) -- ({(\xmax)+0.5},0) node[below] {$x$};
  \draw[-latex] (0,{(\ymin)-0.5}) -- (0,{(\ymax)+0.5}) node[left] {$y$};
  \draw (0,0) node[below left] {$O$};
  % the transformed coordinate system
  \draw[rotate=\a,red,-latex] ({(\xmin)-0.5},0) -- ({(\xmax)+0.5},0) node[below] {$x'$};
  \draw[rotate=\a,red,-latex] (0,{(\ymin)-0.5}) -- (0,{(\ymax)+0.5}) node[left] {$y'$};
  % \draw (0,0) node[below left] {$O$};

  \coordinate (O) at (0,0);
  \coordinate (P) at (2.5,2.5);
  \coordinate (A) at (1,0);
  \coordinate (B) at (\a:1);

  \pic[draw,teal,"$\phi$",angle eccentricity=1.25,angle radius=8mm] {angle=A--O--P};
  \pic[draw,red,"$\theta$",angle eccentricity=1.25,angle radius=12mm] {angle=A--O--B};

  \draw[teal] (O) -- (P);
  \foreach \p/\placement in {P/above}{
    \fill[teal] (\p) circle (2pt);
    \draw (\p) node[\placement] {$\p$};
  }
\end{tikzpicture}
\end{center}

\[
  \begin{cases}
    x = r\cos\phi\\
    y = r\sin\phi
  \end{cases}
\]

\[
  \begin{cases}
    x' = r\cos(\phi-\theta)\\
    y' = r\sin(\phi-\theta)
  \end{cases}
\]

\[
  \begin{cases}
    x' = x\cos\theta+y\sin\theta\\
    y' = y\cos\theta-x\sin\theta
  \end{cases}
\]

\[
  \begin{pmatrix}
    x'\\
    y'\\
    1
  \end{pmatrix}
  =
  \begin{pmatrix}
    \cos\theta & \sin\theta & 0\\
    -\sin\theta & \cos\theta & 0\\
    0 & 0 & 1
  \end{pmatrix}
  \begin{pmatrix}
    x\\
    y\\
    1
  \end{pmatrix}
\]

\[
  \begin{pmatrix}
    x\\
    y\\
    1
  \end{pmatrix}
  =
  \begin{pmatrix}
    \cos\theta & -\sin\theta & 0\\
    \sin\theta & \cos\theta & 0\\
    0 & 0 & 1
  \end{pmatrix}
  \begin{pmatrix}
    x'\\
    y'\\
    1
  \end{pmatrix}
\]

\section{åœ†é”¥æ›²çº¿çš„å˜æ¢}

\subsection{åœ†é”¥æ›²çº¿æ–¹ç¨‹çš„ä¸€èˆ¬å½¢å¼}

è®¾äºŒæ¬¡æ›²çº¿çš„æ–¹ç¨‹ä¸º:

\[
  ax^2 + bxy + cy^2 + dx + ey + f = 0
\]

è®°

\[
  Q = \begin{pmatrix}
    a & b/2 & d/2\\
    b/2 & c & e/2\\
    d/2 & e/2 & f
  \end{pmatrix}
\]

\[
  \mathbf{x} = (x,y,1)^T
\]

åˆ™:

\[
  \mathbf{x}^T Q \mathbf{x} = 0
\]

\subsection{åœ†é”¥æ›²çº¿çš„åˆ‡çº¿æ–¹ç¨‹}

è®¾$\mathbf{x}_0$ æ˜¯åœ†é”¥æ›²çº¿ä¸Šçš„ä¸€ç‚¹, åˆ™è¿‡è¯¥ç‚¹çš„åˆ‡çº¿æ–¹ç¨‹æ˜¯:

\[
  \mathbf{x}_0^T Q \mathbf{x} = 0
\]

\subsection{åœ†é”¥æ›²çº¿çš„ä¸­å¿ƒ}

è®¾ $Q_{31},Q_{32},Q_{33}$ æ˜¯ çŸ©é˜µ Q çš„ä»£æ•°ä½™å­å¼, å¦‚æœ $Q_{33} = 0$, åˆ™æ›²çº¿æ˜¯æŠ›ç‰©çº¿, å…¶ä¸­å¿ƒåœ¨æ— ç©·è¿œå¤„;
å¦åˆ™æ›²çº¿çš„ä¸­å¿ƒæ˜¯$\left(\dfrac{Q_{31}}{Q_{33}}, \dfrac{Q_{32}}{Q_{33}}\right)$.


\subsection{å°†åœ†é”¥æ›²çº¿æ–¹ç¨‹ä»ä¸€èˆ¬å½¢å¼åŒ–ä¸ºæ ‡å‡†å½¢å¼}

å› ä¸ºæŠ›ç‰©çº¿æ˜¯æ²¡æœ‰ä¸­å¿ƒçš„, å¯¹äºä»»æ„åœ†é”¥æ›²çº¿, å¯ä»¥å…ˆè¿›è¡Œæ—‹è½¬, æ¶ˆé™¤äº¤å‰é¡¹ $xy$, ç„¶åå†å¤„ç†.

\subsubsection{æ—‹è½¬åæ ‡ç³»}

é¦–å…ˆæ˜¯æ—‹è½¬, æ¶ˆé™¤äº¤å‰é¡¹ $xy$, æ—‹è½¬è§’åº¦ä¸º $\theta(-\pi/4 \leq \theta \leq \pi/4)$, ä¸”:

\[
  \cot2\theta = \dfrac{1-\tan^2\theta}{2\tan\theta} = \dfrac{a-c}{b}
\]

ä»¤ $\tau = \cot2\theta$, åˆ™:

\[
  \tan^2\theta + 2\tau \tan\theta -1 = 0
\]

å–ç»å¯¹å€¼æœ€å°çš„æ ¹, è¿™æ ·ä¿è¯ $-\pi/4 \leq \theta \leq \pi/4$, å³:

\[
  \tan\theta = \begin{cases}
    - \tau + \sqrt{\tau^2+1}, & \text{if } \tau \geq 0;\\
    - \tau - \sqrt{\tau^2+1}, & \text{otherwise}.
  \end{cases}
\]

\begin{gather*}
  t = \tan\theta\\
  c = \cos\theta = \dfrac{1}{\sqrt{t^2+1}}\\
  s = \sin\theta = \tan\theta \cos\theta = tc
\end{gather*}

è¿™æ ·æ— éœ€è¿›è¡Œä¸‰è§’å‡½æ•°è¿ç®—.

æ„é€ æ—‹è½¬çŸ©é˜µ:

\[
  R =
  \begin{pmatrix}
    c & -s & 0\\
    s & c & 0\\
    0 & 0 & 1
  \end{pmatrix}
\]

è®¡ç®— $\tilde{Q}=R^TQR$ å°±å¾—åˆ°æ–°çš„ç³»æ•°çŸ©é˜µ.

\subsubsection{å¹³ç§»åæ ‡ç³»}

ç„¶åæ ¹æ®ç³»æ•°çŸ©é˜µ $\tilde{Q}$åˆ¤æ–­æ˜¯å¦ä¸ºæŠ›ç‰©çº¿, å³ $\tilde{Q}_{11} = 0$ æˆ– $\tilde{Q}_{22} = 0$. å¦‚æœæ˜¯æŠ›ç‰©çº¿,
åˆ™å°†åæ ‡ç³»å¹³ç§»è‡³é¡¶ç‚¹; å¦åˆ™å°†åæ ‡ç³»å¹³ç§»è‡³ä¸­å¿ƒ.

è‹¥$\tilde{Q}_{11} = 0$ ä¸” $\tilde{Q}_{22} \neq 0$, åˆ™æŠ›ç‰©çº¿ç®€åŒ–ä¸º:

\[
  cy^2+dx+ey+f=0
\] 

å…¶ä¸­:

\begin{gather*}
  c = \tilde{Q}_{22}\\
  d = 2\tilde{Q}_{13}\\
  e = 2\tilde{Q}_{23}\\
  f = \tilde{Q}_{33}
\end{gather*}

åˆ™æŠ›ç‰©çº¿çš„é¡¶ç‚¹ä¸º: $\left(-\dfrac{e}{2c},\dfrac{e^2-4cf}{4cd}\right)$.


\subsection{äº”ç‚¹ç¡®å®šåœ†é”¥æ›²çº¿}

è®¾äºŒæ¬¡æ›²çº¿çš„æ–¹ç¨‹ä¸º:

\[
  ax^2 + bxy + cy^2 + dx + ey + f = 0
\]

å°† $(x_i,y_i) (i=1,2,\cdots,5)$ ä»£å…¥ä¸Šå¼, å¹¶ç»„æˆçº¿æ€§æ–¹ç¨‹ç»„.
ç”±äº $(a, b, c, d, e, f) \neq \mathbf{0}$, è¯¥æ–¹ç¨‹ç»„çš„ç³»æ•°çŸ©é˜µçš„è¡Œåˆ—å¼ä¸º 0, å³:

\[
\det \begin{pmatrix}
x^2 & xy & y^2 & x & y & 1 \\
x^2_1 & x_1y_1 & y^2_1 & x_1 & y_1 & 1 \\
x^2_2 & x_2y_2 & y^2_2 & x_2 & y_2 & 1 \\
x^2_3 & x_3y_3 & y^2_3 & x_3 & y_3 & 1 \\
x^2_4 & x_4y_4 & y^2_4 & x_4 & y_4 & 1 \\
x^2_5 & x_5y_5 & y^2_5 & x_5 & y_5 & 1 \\
\end{pmatrix} = 0
\]

åŒ–ç®€è¯¥è¡Œåˆ—å¼å³å¾—åˆ°äºŒæ¬¡æ›²çº¿çš„æ–¹ç¨‹.

\subsection{ä¸äº”æ¡ç›´çº¿ç›¸åˆ‡çš„åœ†é”¥æ›²çº¿}

æ ¹æ®å¯¹å¶åŸç†, äºŒæ¬¡æ›²çº¿å¯ä»¥ç”¨ä¸¤ç§æ–¹å¼å®šä¹‰, ç‚¹å½¢å¼å’Œç›´çº¿å½¢å¼:

ç‚¹å½¢å¼å®šä¹‰: ç”±ç‚¹é›†æ»¡è¶³çš„äºŒæ¬¡æ–¹ç¨‹å®šä¹‰, ä¾‹å¦‚:
  \[
  ax^2 + bxy + cy^2 + dxz + eyz + fz^2 = 0
  \]
  
ç”¨çŸ©é˜µå½¢å¼è¡¨ç¤ºä¸º:
  \[
  (x, y, z) \begin{pmatrix} a & b/2 & d/2 \\ b/2 & c & e/2 \\ d/2 & e/2 & f \end{pmatrix} \begin{pmatrix} x \\ y \\ z \end{pmatrix} = 0
  \]
ç§°è¯¥çŸ©é˜µä¸º \( Q \).

è®¾ $(x_0,y_0,z_0)$ æ˜¯æ›²çº¿ä¸Šçš„ç‚¹,  åˆ™è¿‡è¯¥ç‚¹çš„åˆ‡çº¿æ–¹ç¨‹ä¸º:

\[
  (x_0,y_0,z_0) \begin{pmatrix} a & b/2 & d/2 \\ b/2 & c & e/2 \\ d/2 & e/2 & f \end{pmatrix} \begin{pmatrix} x \\ y \\ z \end{pmatrix} = 0
\]


ç›´çº¿å½¢å¼å®šä¹‰: ç”±æ‰€æœ‰ä¸åŸæ›²çº¿ç›¸åˆ‡çš„ç›´çº¿çš„åŒ…ç»œå®šä¹‰ï¼Œç”¨ç›´çº¿åæ ‡ \( (l, m, n) \) çš„äºŒæ¬¡æ–¹ç¨‹è¡¨ç¤º:
  \[
  Al^2 + Blm + Cm^2 + Dlm + Emn + Fn^2 = 0
  \]
åŒæ ·ç”¨çŸ©é˜µå½¢å¼ï¼š
  \[
  (l, m, n) \begin{pmatrix} A & B/2 & D/2 \\ B/2 & C & E/2 \\ D/2 & E/2 & F \end{pmatrix} \begin{pmatrix} l \\ m \\ n \end{pmatrix} = 0
  \]
ç§°è¯¥çŸ©é˜µä¸º $Q^*$. $Q^*$ æ˜¯ $Q$ çš„ä¼´éšçŸ©é˜µ:

\[
  Q^{-1} = \dfrac{Q^*}{\det(Q)}.
\]

æˆ‘ä»¬å¯ä»¥æ ¹æ® 5 æ¡ç›´çº¿çš„æ–¹ç¨‹æ±‚å‡º $Q^*$, å†æ±‚å…¶é€†çŸ©é˜µ, ä»è€Œå¾—åˆ°æ›²çº¿çš„æ–¹ç¨‹.

Find dual conic\footnote{\url{https://math.stackexchange.com/questions/460404/finding-dual-conic}}:

Taking the quadratic form $p^TAp=0$ and remembering $A$ 
is symmetric, we can also transform it:
\begin{gather*}
  p^T(AA^{-1})Ap=0 \\
  p^TA^TA^{-1}Ap=0 \\
  (Ap)^TA^{-1}(Ap)=0 
\end{gather*}

This modified form can be interpreted as the dual of the primal conic described by the quadratic form $l^ğ‘‡ğ´^{âˆ’1}l=0$
, where every $l=Ap$ that satisfies this equation is tangent to the primal conic.

Additionally, the adjugate of $A$ can mostly be substituted for the inverse because $A^{-1}=adj(A)/det(A)$.